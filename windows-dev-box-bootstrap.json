{
  "schemaVersion": "2.2",
  "description": "Install all the required packages for a Windows Dev Box",
  "mainSteps": [
    {
      "precondition": {
        "StringEquals": [
          "platformType",
          "Windows"
        ]
      },
      "action": "aws:runPowerShellScript",
      "name": "InstallChocolatey",
      "inputs": {
        "id": "0.aws:runPowerShellScript",
        "timeoutSeconds": 1800,
        "runCommand": [
          "iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))",
          "Import-Module \"$env:ChocolateyInstall\\helpers\\chocolateyInstaller.psm1\"",
          "choco feature enable -n allowGlobalConfirmation",
          "choco install awscli awstools.powershell",
          "choco install visualstudio2019community visualstudio2019-workload-netcoretools",
          "choco install docker",
          "Write-Verbose \"choco Done!\"",
          "Invoke-RestMethod https://github.com/awslabs/aws-sam-cli/releases/latest/download/AWS_SAM_CLI_64_PY3.msi -OutFile \"{$env:TEMP}AWS_SAM_CLI_64_PY3.msi\"",
          "Start-Process -Wait msiexec.exe -ArgumentList /I \"{$env:TEMP}AWS_SAM_CLI_64_PY3.msi\" /quiet"
        ]
      }
    },
    {
      "action": "aws:applications",
      "name": "Install SAM",
      "inputs": {
         "id": "1.aws:applications",
         "action": "Install",
         "source": "https://github.com/awslabs/aws-sam-cli/releases/latest/download/AWS_SAM_CLI_64_PY3.msi"        
       }
    }
  ]
}
